# Условия

# HW1 

Зайти на Кинопоиск, найти 5 любимых фильмов и сделать по ним табличку с данными.
## Табличка films:

* title - название (текст)

* id (число) соответствует film_id в табличке persons2content

* country страна (текст)

* box_office сборы в долларах (число)

* release_year год выпуска (timestamp)


## Табличка persons

* id (число) - соответствует person_id в табличке persons2content

* fio (текст) фамилия, имя


### Табличка persons2content

* person_id (число) - id персоны

* film_id (число) - id контента

* person_type (текст) тип персоны (актёр, режиссёр и т.д.)

Таким образом реализуется схема БД "Звезда" с центром в табличке persons2content



# HW2

## 1. Простые выборки

1.1 SELECT , LIMIT - выбрать 10 записей из таблицы rating (Для всех дальнейших запросов выбирать по 10 записей, если не указано иное)

1.2 WHERE, LIKE - выбрать из таблицы links всё записи, у которых imdbid оканчивается на "42", а поле movieid между 100 и 1000


## 2. Сложные выборки: JOIN

2.1 INNER JOIN выбрать из таблицы links все imdbId, которым ставили рейтинг 5


## 3. Аггрегация данных: базовые статистики

3.1 COUNT() Посчитать число фильмов без оценок

3.2 GROUP BY, HAVING вывести top-10 пользователей, у который средний рейтинг выше 3.5


## 4. Иерархические запросы

4.1 Подзапросы: достать любые 10 imbdId из links у которых средний рейтинг больше 3.5.

4.2 Common Table Expressions: посчитать средний рейтинг по пользователям, у которых более 10 оценок. Нужно подсчитать средний рейтинг по все пользователям, которые попали под условие - то есть в ответе должно быть одно число.


# HW3

## Оконные функции

Вывести список пользователей в формате userId, movieId, normed_rating, avg_rating где

* userId, movieId - без изменения

* для каждого пользователя преобразовать рейтинг r в нормированный - normed_rating=(r - r_min)/(r_max - r_min), где r_min и r_max соответственно минимально и максимальное значение рейтинга у данного пользователя

* avg_rating - среднее значение рейтинга у данного пользователя
Вывести первые 30 таких записей

## ETL
ETL - процесс выгрузки данных, обработки и их дальнейшеней загрузки. В рамках домашней работы нужно проделать все три этапа

* Extract

* Transform

* Load
